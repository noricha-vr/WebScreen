<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>ScreenCapture</title>
</head>
<body>
<main>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">ScreenCapture</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="/">URL</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/image/">Image</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/desktop/">Desktop</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/github/">GitHub</a>
                        </li>

                    </ul>

                </div>
            </div>
        </nav>
    </header>

    <!--    {% block content %}-->

    <div class="container">
        <section class="section mt-5">
            <div class="row justify-content-md-center">
                <div class="col mt-3">
                    <h1 class="h1 mb-5">ScreenCapture</h1>
                    <h2 class="h3 mb-3">VRChatにデスクトップを共有しよう！</h2>
                </div>
                <div>
                    1.このコードをターミナルに貼り付ける
                    <pre class="bg-dark text-white p-3 mt-2">
                        <code>
while true;
do
    screencapture -x -t jpg /tmp/desktop.jpg
    curl -X POST -F "file=@/tmp/desktop.jpg" -H 'X-Token: <span name="uuid">uuid</span>' <span name="origin">uuid</span>/api/desktop/
    sleep 3
done</code>
                    </pre>
                    ※ Pythonスクリプト<a href="https://storage.googleapis.com/vrchat/post_client/post_desktop.py">post_desktop.py</a>
                </div>
                <div class="mt-3">
                    2.このURLをVRChatの動画プレイヤーに貼り付ける<br/>
                    <a id="player_url"></a>
                </div>
            </div>
        </section>
    </div>
    <!--    {% endblock %}-->

    <footer>

    </footer>
</main>

<!-- Optional JavaScript; choose one of the two! -->

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

<!-- Option 2: Separate Popper and Bootstrap JS -->
<!--
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
-->
</body>
<script>
    function uuidv4() {
        return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>
            (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
        );
    }

    let uuid = localStorage.getItem("uuid");
    if (uuid === null) {
        uuid = uuidv4();
        localStorage.setItem("uuid", uuid);
        console.log(`created uuid`);
    }
    console.log(`current uuid: ${uuid}`);
    document.getElementsByName("uuid").forEach(e => e.innerText = uuid);
    document.getElementsByName("origin").forEach(e => e.innerText = location.origin);
    document.getElementById("player_url").innerText = `${location.origin}/api/desktop/${uuid}`;
    document.getElementById("player_url").href = `${location.origin}/api/desktop/${uuid}`;

</script>
</html>